{% extends 'core/base.html' %}
{% load static %}

{% block content %}

<a href="{% url 'item_list' %}" class="btn btn-link">&larr; Back to items</a>

<div class="row mt-3">
    <div class="col-md-6">
        {% if item.image %}
        <img src="{{ item.image.url }}" class="img-fluid rounded shadow">
        {% endif %}
    </div>

    <div class="col-md-6">

        <div class="d-flex justify-content-between align-items-center">
            <h2>{{ item.title }}</h2>

            {% if item.is_claimed %}
                <span class="badge text-bg-success">Claimed</span>
            {% else %}
                <span class="badge text-bg-warning">Found</span>
            {% endif %}
        </div>

        <p class="text-muted mt-2">

            {% if item.category.name == "Clothing" %}
                ðŸ‘• Clothing
            {% elif item.category.name == "Electronics" %}
                ðŸŽ§ Electronics
            {% elif item.category.name == "Accessories" %}
                ðŸŽ’ Accessories
            {% elif item.category.name == "School Supplies" %}
                ðŸ“š School Supplies
            {% else %}
                ðŸ“¦ {{ item.category.name }}
            {% endif %}
            <br>

            Found at: {{ item.location_found }}<br>
            Date found: {{ item.date_found }}
        </p>

        <p>{{ item.description }}</p>

        <!-- FIX: Correct URL â†’ mark_claimed -->
        {% if not item.is_claimed %}
        <form method="POST"
              action="{% url 'mark_claimed' item.pk %}"
              onsubmit="return confirm('Are you sure this item has been claimed?');">
            {% csrf_token %}
            <button class="btn btn-success w-100">Mark as claimed</button>
        </form>
        {% else %}
        <p class="alert alert-success mt-3 text-center">
            This item has been claimed.
        </p>
        {% endif %}

        {% if user.is_staff %}
        <hr>
        <div class="d-flex gap-2 mt-3">
            <a href="{% url 'item_edit' item.pk %}" class="btn btn-outline-secondary w-50">
                Edit
            </a>
            <a href="{% url 'item_delete' item.pk %}" class="btn btn-outline-danger w-50">
                Delete
            </a>
        </div>
        {% endif %}

        <hr>

        <a href="{% url 'report_item' item.pk %}"
           class="btn btn-outline-warning w-100 mt-2">
            Report incorrect / inappropriate
        </a>

    </div>
</div>

{% endblock %}
